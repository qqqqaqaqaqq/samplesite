@use "sass:color";

$primary-color: #007bff;
$bg-color: #f8f9fa;
$card-bg: #ffffff;
$text-muted: #999;
$border-color: #eee;
$success-color: #61c9aa;

.security-container {
  background: $bg-color;
  padding: 2rem 1rem;
  border-radius: 24px;
  display: flex;
  flex-direction: column;
  align-items: center;
  font-family: 'Inter', system-ui, sans-serif;
  box-shadow: 0 20px 50px rgba(0, 0, 0, 0.05);
  
  // 모바일 짤림 방지 및 제스처 방지
  width: calc(100% - 2rem); 
  max-width: 500px;
  margin: 1rem auto;
  position: relative;
  overflow: hidden;
  box-sizing: border-box;
  overscroll-behavior: none; // 스크롤 바운스 방지
  user-select: none;
  -webkit-tap-highlight-color: transparent;

  .loading-overlay {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba($card-bg, 0.85);
    backdrop-filter: blur(10px);
    z-index: 100;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;

    .loader {
      width: 40px; height: 40px;
      border: 4px solid color.adjust($primary-color, $lightness: 40%);
      border-top: 4px solid $primary-color;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    p { margin-top: 1rem; color: $primary-color; font-weight: 700; animation: blink 1.5s infinite; }
  }

  .content-wrapper {
    width: 100%;
    transition: all 0.4s ease;
    &.blur { filter: blur(6px); opacity: 0.5; pointer-events: none; transform: scale(0.97); }
  }

  .security-header {
    display: flex; gap: 0.5rem; margin-bottom: 1.5rem; width: 100%;
    .stat-box {
      background: $card-bg; padding: 0.8rem 0.2rem; border-radius: 12px; border: 1px solid $border-color;
      flex: 1; text-align: center; position: relative; overflow: hidden;
      .label { display: block; font-size: 0.6rem; color: $text-muted; font-weight: 700; margin-bottom: 0.2rem; }
      .value { font-size: 1rem; font-weight: 900; color: #333; }
      .progress-bar {
        position: absolute; bottom: 0; left: 0; width: 100%; height: 4px; background: #f1f3f5;
        .fill { height: 100%; background: $primary-color; transition: width 0.15s ease-out; }
      }
    }
  }

  .security-area {
    background: $card-bg;
    border: 1px solid #eee;
    border-radius: 20px;
    width: 100%;
    aspect-ratio: 1 / 1;
    touch-action: none !important; // 모바일 브라우저 개입 차단
    overflow: hidden;
    position: relative;
    display: flex; justify-content: center; align-items: center;
    -webkit-user-drag: none;
  }

  // PatternGame 관련 스타일
  .game-wrapper {
    width: 100%; height: 100%;
    .pattern-container {
      .grid-dot {
        width: 18px; height: 18px; background: #f1f3f5; border-radius: 50%; transform: translate(-50%, -50%);
        &.is-target { background: $success-color; box-shadow: 0 0 15px rgba($success-color, 0.4); z-index: 2; }
      }
      .target-pulse {
        position: absolute; width: 36px; height: 36px; border: 2px solid rgba($success-color, 0.3);
        border-radius: 50%; transform: translate(-50%, -50%); animation: target-expand 2s infinite ease-out;
      }
      .player-ball {
        width: 34px; height: 34px; border-radius: 50%; z-index: 10; border: 3px solid #fff;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }
    }
  }

  .security-panel {
    margin-top: 1.2rem;
    .status-indicator {
      display: flex; align-items: center; gap: 0.5rem; justify-content: center;
      .dot { 
        width: 8px; height: 8px; border-radius: 50%; background: #dee2e6; 
        &.active { background: $primary-color; box-shadow: 0 0 8px rgba($primary-color, 0.5); animation: status-blink 1.2s infinite; }
      }
      span { font-size: 0.75rem; font-weight: 700; color: #666; }
    }
    .hint { font-size: 0.65rem; color: #bbb; margin-top: 0.5rem; line-height: 1.4; word-break: keep-all; }
  }
}

@keyframes spin { to { transform: rotate(360deg); } }
@keyframes blink { 50% { opacity: 0.5; } }
@keyframes status-blink { 50% { opacity: 0.5; transform: scale(0.9); } }
@keyframes target-expand { 0% { transform: translate(-50%, -50%) scale(0.6); opacity: 0.8; } 100% { transform: translate(-50%, -50%) scale(2.2); opacity: 0; } }